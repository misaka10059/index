/*
 * imgPreview jQuery plugin
 * Copyright (c) 2009 James Padolsey
 * j@qd9.co.uk | http://james.padolsey.com
 * Dual licensed under MIT and GPL.
 * Updated: 09/02/09
 * @author James Padolsey
 * @version 0.22
 */
(function(b){b.expr[":"].linkingToImage=function(f,g,a){return!(!b(f).attr(a[3])||!b(f).attr(a[3]).match(/\.(gif|jpe?g|png|bmp)$/i))};b.fn.imgPreview=function(f){function g(c){return c.replace(/(\/?)([^\/]+)$/,"$1"+a.thumbPrefix+"$2")}var a=b.extend({imgCSS:{},distanceFromCursor:{top:10,left:10},preloadImages:!0,onShow:function(){},onHide:function(){},onLoad:function(){},containerID:"imgPreviewContainer",containerLoadingClass:"loading",thumbPrefix:"",srcAttr:"href"},f);b("#"+a.containerID).remove();
var d=b("<div/>").attr("id",a.containerID).append("<img/>").hide().css({position:"absolute","z-index":1E3}).appendTo("body"),e=b("img",d).css(a.imgCSS),l=b(window),k=this.filter(":linkingToImage("+a.srcAttr+")");a.preloadImages&&function(c){var d=new Image,e=arguments.callee;d.src=g(b(k[c]).attr(a.srcAttr));d.onload=function(){k[c+1]&&e(c+1)}}(0);k.mousemove(function(c){var b=d.offset().left,f=e.outerHeight(),h={left:c.pageX+a.distanceFromCursor.left+"px"},g=e.outerWidth(),b=l.width()-b-g,k=c.pageY+
a.distanceFromCursor.top,m=window.pageYOffset+l.height();k+f>=m?(h.bottom=0,h.position="fixed",h.top=""):(h.position="absolute",h.top=c.pageY+a.distanceFromCursor.top+"px");0>b?e.css("max-width",g+b+"px"):e.css(a.imgCSS);d.css(h)}).hover(function(){var c=this;d.addClass(a.containerLoadingClass).show();e.on('load',function(){d.removeClass(a.containerLoadingClass);e.show();a.onLoad.call(e[0],c)}).attr("src",g(b(c).attr(a.srcAttr)));a.onShow.call(d[0],c)},function(){d.hide();e.off("load").attr("src","").hide();
a.onHide.call(d[0],this)});return this}})(jQuery);